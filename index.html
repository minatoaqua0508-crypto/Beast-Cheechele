<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é‡ç¸åˆ‡åˆ‡æ¨‚</title>
    <meta name="description" content="é‡ç¸åˆ‡åˆ‡æ¨‚">
  <meta name="keywords" content="é‡ç¸åˆ‡åˆ‡æ¨‚,é‡ç¸, åˆ‡åˆ‡æ¨‚,114514,é‡ç¸å‰è¼©,é‡ç¸å‰è¼©éŠæˆ²">
  <meta name="author" content="é»ƒéŸ‹å‚‘å­¸è€…">
  <meta property="og:title" content="é‡ç¸åˆ‡åˆ‡æ¨‚">
  <meta property="og:description" content="äº«å—é‡ç¸çš„å’†å˜¯">
  <meta property="og:image" content="https://minatoaqua0508-crypto.github.io/Beast-Cheechele//images/logo1.jfif">
  <meta property="og:url" content="https://minatoaqua0508-crypto.github.io/Beast-Cheechele//index.html">
  <meta property="og:type" content="website">
<meta property="og:site_name" content="é‡ç¸åˆ‡åˆ‡æ¨‚">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://minatoaqua0508-crypto.github.io/Beast-Cheechele//index.html">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
       * {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Arial', sans-serif;
  background: #f8f2ee;
  overflow: hidden;
  user-select: none;
  height: 100vh;
  display: flex;
  flex-direction: column; /* ä¸Šä¸‹æ’åˆ—ï¼šä¸Šæ–¹å·¥å…·åˆ— + ä¸‹æ–¹éŠæˆ² */
}
.credit {
        position: fixed;         /* å›ºå®šåœ¨è¦–çª—ï¼Œè€Œä¸æ˜¯è·Ÿè‘—å…§å®¹ */
        bottom: 10px;            /* è·é›¢åº•éƒ¨ 10px */
        right: 10px;             /* è·é›¢å³é‚Š 10px */
        font-size: 12px;         /* å­—é«”å°ä¸€é» */
        color: rgba(0, 0, 0, 0.3); /* åŠé€æ˜ç°è‰² */
        font-style: italic;      /* æ–œé«” */
        pointer-events: none;    /* ä¸å½±éŸ¿æ»‘é¼ é»æ“Š */
        user-select: none;       /* ä¸èƒ½é¸å–æ–‡å­— */
    }
.game-container {
  flex: 1; /* éŠæˆ²å€åŸŸå¡«æ»¿å‰©é¤˜ç©ºé–“ */
  display: flex;
  width: 100%;
}

.game-area {
  flex: 1;
  position: relative;
  background: #D2B48C;
  overflow: hidden;
  cursor: crosshair;
  touch-action: none;       /* è®“è§¸æ§äº‹ä»¶ä¸è¢«æ²å‹•åƒæ‰ */
  overscroll-behavior: contain;
}

.score-display {
  position: absolute;
  top: 20px;
  left: 20px;
  font-size: 24px;
  font-weight: bold;
  color: #4A4A4A;
  z-index: 1000;
}

.sidebar {
  position: relative; /* ç‚ºé®ç½©å®šä½ */
  width: 100%;
  min-height: 60px;
  background: url("imags/logo30.jpg") center/cover no-repeat;
  padding: 8px 20px;
  display: flex;
  align-items: flex-start;
  gap: 30px;
  flex: 0 0 auto;
}

.sidebar::before {
  content: "";
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,.18); /* é®ç½©æ¿ƒæ·¡å¯èª¿ */
  pointer-events: none;
}
/* å¦‚æœç”¨äº†é®ç½©ï¼Œè®“å…§å®¹åœ¨é®ç½©ä¹‹ä¸Š */
.sidebar > * { position: relative; z-index: 1; }

/* title */
.sidebar-section h2 {
  font-size: 16px;   /* title */
  font-weight: 500;
  color: #87CEFA;    /* æ·¡è—è‰² */
  margin-bottom: 6px;
  text-align: center;
}

/* éŠæˆ²æ¨™é¡Œæ¬„ä½ */
.sidebar-section.game-title {
  width: 300px;
  min-height: 80px;
  background: #8da1c8;  /* èƒŒæ™¯è‰² */
  border-radius: 8px;
  padding: 51px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  display: flex;
  flex-direction: column;  /* å‚ç›´æ’åˆ— */
  align-items: center;
  justify-content: flex-start;
  gap: 10px;  /* æ¨™é¡Œèˆ‡æŒ‰éˆ•é–“è· */
}

/* again æŒ‰éˆ• */
.again-btn {
  padding: 8px 14px;
  border: none;
  border-radius: 5px;
  background: #FF6B35;
  color: white;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.again-btn:hover {
  background: #FF8C69;
  transform: scale(1.05);
}

/* æ­·å²æœ€é«˜åˆ†æ•¸ */
.sidebar-section h3 {
  font-size: 20px;
  font-weight: bold;
  color: #8B4513;
  margin-bottom: 8px;
  text-align: center;
}

/* æ­·å²æœ€é«˜åˆ†æ•¸æ¬„ä½ */
.sidebar-section.high-score {
  width: 300px;
  min-height: 80px;
  background: #8da1c8;
  border-radius: 8px;
  padding: 36px;
  display: flex;
  flex-direction: column;  /* å‚ç›´æ’åˆ— */
  align-items: center;
  justify-content: flex-start;
  gap: 10px; /* æ¨™é¡Œèˆ‡æŒ‰éˆ•é–“è· */
  color: black;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

/* stop æŒ‰éˆ• */
#pauseBtn {
  padding: 8px 14px;
  border: none;
  border-radius: 5px;
  background: #ee1818;
  color: white;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s ease;
}

#pauseBtn:hover {
  background: #ee1818;
  transform: scale(1.05);
}

/* å¯åˆ‡ç‰©é«” */
.sidebar-section h4 {
  font-size: 20px;  /* å¯åˆ‡ç‰©é«” */
  font-weight: 800;
  color: #98FB98;   /* æ·¡ç¶ è‰² */
  margin-bottom: 6px;
}

/* å¯åˆ‡ç‰©æ¬„ä½èª¿æ•´ */
.sidebar-section.fruit-info .fruit {
  padding: 11px 50px;
  position: static !important;  /* å–æ¶ˆ absolute */
  left: auto; top: auto;        /* æ¸…æ‰å®šä½ */
  transform: none;
  display: block;               /* ä¸€å€‹é …ç›®ä¸€è¡Œ */
  float: none;
  margin: 0;                    /* é–“è·äº¤çµ¦ gap/ä¸‹é¢é€™è¡Œ */
  line-height: 1.6;
}

.sidebar-section.fruit-info {
  display: flex;
  flex-direction: column;
  gap: 10px;                    /* æ¨™é¡Œèˆ‡æ¯å€‹é …ç›®ä¹‹é–“çš„é–“è· */
}

/* å‚‘å“¥ï¼Œé‡ç¸(ç¶ å­—)ï¼Œç­‰ç­‰æ¢ç›®  */
.fruit.positive {
  color: #1ee743;
  font-size: 20px;
}
.fruit.positive1 {
  color: #f00d0d;
  font-size: 20px;
}
/* ç©åˆ†å…Œæ› */
.sidebar-section h5 {
  font-size: 16px;  /* ç©åˆ†å…Œæ› */
  font-weight: 500;
  color: #01090e;   /* æ·¡è—è‰² */
  margin-bottom: 6px;
}

/* ç©åˆ†å…Œæ›æ¬„ä½èª¿æ•´ */
.sidebar-section.exchange {
  width: 240px;          /* å›ºå®šå¯¬åº¦ */
  min-height: 160px;     /* å›ºå®šé«˜åº¦ */
  background: #8da1c8;   /* æ·±è—ç°èƒŒæ™¯ */
  border-radius: 8px;    /* åœ“è§’ */
  padding: 1px;          /* å…§è· */
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  gap: 8px;              /* æ¨™é¡Œèˆ‡æŒ‰éˆ•é–“è· */
  color: white;
  padding-bottom: 10px;  /* ä¿è­‰æœ€å¾ŒæŒ‰éˆ•åº•ä¸‹æœ‰ç©ºé–“ */
}

/* ğŸ¯ æŒ‰éˆ•çµ±ä¸€æ¨£å¼ */
.sidebar-section.exchange button {
  width: 200px;          /* çµ±ä¸€å¯¬åº¦ */
  height: 40px;          /* çµ±ä¸€é«˜åº¦ */
  border: none;
  border-radius: 5px;
  background: #FF6B35;   /* çµ±ä¸€ç¶ è‰² */
  color: white;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s ease;
}

/* ğŸ¯ æŒ‰éˆ• hover æ•ˆæœ */
.sidebar-section.exchange button:hover:enabled {
  background: #FF8C69;   /* äº®ç¶ è‰² */
  transform: scale(1.05);
}

/* ğŸ¯ åœç”¨ç‹€æ…‹ä¿æŒåŸç¨‹å¼æ©Ÿåˆ¶ */
.sidebar-section.exchange button:disabled {
  background: #888;      /* ç°è‰² (ä¿ç•™åŸæ©Ÿåˆ¶) */
  cursor: not-allowed;
  transform: none;
}

/* å…ˆæŠŠé é¢åº•è‰²çµ±ä¸€ç‚ºå’–å•¡è‰²ï¼Œé¿å…ä»»ä½•åœ°æ–¹éœ²ç™½ */
html, body { background:#8B4513 !important; }

.fruit-img[src*="logo2.webp"] { width: 150px; height: 150px; }
/* æ¡Œæ©Ÿé è¨­ï¼šæ‰€æœ‰æ°´æœåœ–ç‰‡éƒ½æ˜¯ 100x100 */
.fruit-img[src*="logo0.jfif"],
.fruit-img[src*="logo1.jfif"],
.fruit-img[src*="logo3.jpg"],
.fruit-img[src*="logo4.jfif"],
.fruit-img[src*="logo5.jfif"],
.fruit-img[src*="logo6.jfif"],
.fruit-img[src*="logo7.jpeg"],
.fruit-img[src*="logo8.jfif"],
.fruit-img[src*="logo9.jfif"],
.fruit-img[src*="logo10.jfif"],
.fruit-img[src*="logo11.jfif"],
.fruit-img[src*="logo12.jpg"],
.fruit-img[src*="logo13.jfif"],
.fruit-img[src*="logo14.jfif"],
.fruit-img[src*="logo15.jfif"],
.fruit-img[src*="logo16.jfif"],
.fruit-img[src*="logo17.jfif"],
.fruit-img[src*="logo18.jfif"],
.fruit-img[src*="logo20.jfif"],
.fruit-img[src*="logo21.png"],
.fruit-img[src*="logo22.png"],
.fruit-img[src*="logo23.jfif"],
.fruit-img[src*="logo24.jfif"],
.fruit-img[src*="logo25.jpg"],
.fruit-img[src*="logo26.jpg"],
.fruit-img[src*="logo27.jpg"],
.fruit-img[src*="logo28.jfif"],
.fruit-img[src*="logo29.jfif"],
.fruit-img[src*="logo30.jpg"] {
  width: 100px;
  height: 100px;
  border-radius: 12px;   /* âœ… åŠ ä¸Šåœ“è§’è¨­è¨ˆ */
  object-fit: cover;     /* âœ… ä¿æŒæ¯”ä¾‹å¡«æ»¿ï¼Œä¸æœƒè®Šå½¢ */
}


/* æ‰‹æ©Ÿç‰ˆï¼ˆå¯¬åº¦ â‰¤390pxï¼‰ï¼šç¸®å°æ°´æœåœ–ç‰‡ */
@media (max-width: 450px) {
  .fruit-img[src*="logo0.jfif"],
  .fruit-img[src*="logo1.jfif"],
  .fruit-img[src*="logo3.jpg"],
  .fruit-img[src*="logo4.jfif"],
  .fruit-img[src*="logo5.jfif"],
  .fruit-img[src*="logo6.jfif"],
  .fruit-img[src*="logo7.jpeg"],
  .fruit-img[src*="logo8.jfif"],
  .fruit-img[src*="logo9.jfif"],
  .fruit-img[src*="logo10.jfif"],
  .fruit-img[src*="logo11.jfif"],
  .fruit-img[src*="logo12.jpg"],
  .fruit-img[src*="logo13.jfif"],
  .fruit-img[src*="logo14.jfif"],
  .fruit-img[src*="logo15.jfif"],
  .fruit-img[src*="logo16.jfif"],
  .fruit-img[src*="logo17.jfif"],
  .fruit-img[src*="logo18.jfif"],
  .fruit-img[src*="logo20.jfif"],
  .fruit-img[src*="logo21.png"],
  .fruit-img[src*="logo22.png"],
  .fruit-img[src*="logo23.jfif"],
  .fruit-img[src*="logo24.jfif"],
  .fruit-img[src*="logo25.jpg"],
  .fruit-img[src*="logo26.jpg"],
  .fruit-img[src*="logo27.jpg"],
  .fruit-img[src*="logo28.jfif"],
  .fruit-img[src*="logo29.jfif"] {
    width: 50px;   /* ç¸®å°å°ºå¯¸ */
    height: 50px;
    border-radius: 8px;   /* âœ… å°è¢å¹•ç¸®å°ï¼Œä½†ä»ä¿ç•™åœ“è§’ */
    object-fit: cover;
  }
  .fruit-img[src*="logo2.webp"] { width: 80px; height: 80px; }
}


        .fruit {
            position: absolute;
            font-size: 40px;
            z-index: 100;
            transition: all 0.1s ease;
        }

        .bomb {
            position: absolute;
            font-size: 40px;
            z-index: 100;
        }

        .slice-line {
            position: absolute;
            height: 3px;
            background: linear-gradient(90deg, #FFD700, #FFA500);
            border-radius: 2px;
            pointer-events: none;
            z-index: 50;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
        }

        @keyframes sliceEffect {
            0% { 
                transform: scale(1) rotate(0deg); 
                opacity: 1; 
            }
            50% { 
                transform: scale(1.2) rotate(180deg); 
                opacity: 0.7; 
            }
            100% { 
                transform: scale(0.8) rotate(360deg); 
                opacity: 0; 
            }
        }

        .sliced {
            animation: sliceEffect 0.8s ease-out forwards;
        }

        .special-red,.special-fruit {
            position: absolute;
            font-size: 60px;
            z-index: 90;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
             width: 60px; height: 60px;  /* æ²’æœ‰å°±è£œä¸Šï¼›æœ‰å‹•æ…‹å°ºå¯¸ä¹Ÿå¯ */
  touch-action: none;         /* å…ƒä»¶æœ¬èº«ä¹Ÿåœç”¨é è¨­æ‰‹å‹¢ */
        }

        .special-red,.special-fruit:hover {
            transform: scale(1.1);
            filter: brightness(1.2);
        }

        .special-red,.special-fruit:active {
            transform: scale(0.95);
        }

        @keyframes touchReaction {
            0% { transform: scale(1); }
            50% { transform: scale(1.3) rotate(10deg); }
            100% { transform: scale(1) rotate(0deg); }
        }

        .special-red,.special-fruit.touched {
            animation: touchReaction 0.5s ease-out;
        }

        .fruit-info {
            background: rgba(0,0,0,0.8);
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
        }

        .fruit-info div {
            margin: 5px 0;
            font-size: 18px;
        }
.special-fruit img {
  width: 70px;
  height: 70px;
  object-fit: contain;
}
.special-fruit, .special-red {
  position: absolute;
  cursor: grab;
}
       

       
        

        .game-title {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .game-title h2 {
            color: #8B4513;
            font-size: 24px;
            font-weight: bold;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            letter-spacing: 2px;
        }

        .high-score {
            background: rgba(255,215,0,0.2);
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-size: 18px;
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
                margin-right: 10px;
                padding: 15px;
            }
            
            .fruit, .bomb {
                font-size: 35px;
            }
            
            .score-display {
                font-size: 20px;
            }
        }
        
:root{
  --drawer-handle: 36px; /* æ”¶ç´æ™‚çš„ä¿ç•™é«˜åº¦(å°æ©«æ¢é«˜åº¦) */
}

/* â–¶ é è¨­ï¼šå³ä¸Šè§’ */
.drawer-toggle{
  position: absolute;
  top: 8px;
  right: 10px;         /* â† å³ä¸Š */
  left: auto;
 width: 40px;         /* 28 â†’ 40 */
  height: 40px;        /* 28 â†’ 40 */
  line-height: 40px;   /* è®“å­—å‚ç›´ç½®ä¸­ */
  font-size: 20px;     /* 16 â†’ 20ï¼Œç®­é ­æ›´å¤§ */
  border: 0;
  border-radius: 50%;
  background: #333;
  color: #fff;
  cursor: pointer;
  box-shadow: 0 2px 6px rgba(0,0,0,.25);
  transition: transform .25s ease, background .25s ease;
  z-index: 10;         /* è“‹éé¢æ¿å…§å…¶ä»–å…ƒç´  */
}
.drawer-toggle:hover{ transform: scale(1.06); }

/* è®“ sidebar æ”¯æ´é«˜åº¦å‹•ç•« */
.sidebar{
  position: relative;
  transition: height .25s ease, padding .25s ease, background .25s ease, box-shadow .25s ease;
}

/* â–¶ æ”¶ç´ï¼šæ•´å€‹ sidebar æ”¶èµ· */
body.drawer-collapsed .sidebar{
  height: 0;
  min-height: 0;
  padding: 0;
  border: 0;
  box-shadow: none;
  background: transparent;
  overflow: hidden;
}

/* â–¶ æ”¶ç´æ™‚ï¼šåˆ‡æ›éµå›ºå®šå³ä¸Šè§’ï¼ˆä¸å— sidebar å½±éŸ¿ï¼‰ */
body.drawer-collapsed .drawer-toggle{
  position: fixed;
  top: max(10px, env(safe-area-inset-top));
  right: max(10px, env(safe-area-inset-right));  /* â† å³ä¸Š */
  left: auto;
   width: 44px;         /* 32 â†’ 44 */
  height: 44px;        /* 32 â†’ 44 */
  line-height: 44px;
  font-size: 22px;     /* ç¬¦è™Ÿæ›´æ¸…æ¥š */
  border: 0;
  border-radius: 50%;
  background: #222;
  color: #fff;
  z-index: 1002;  /* è“‹åœ¨éŠæˆ²å€ä¸Šæ–¹ */
  box-shadow: 0 2px 6px rgba(0,0,0,.25);
}

/* â–¶ å°è¢å¹•å¾®èª¿ï¼ˆé¿å…è²¼é‚Š/ç€æµ·ï¼‰ */
@media (max-width: 390px){
  .drawer-toggle{
    top: 6px;
    right: max(8px, env(safe-area-inset-right));
    left: auto;
  }
}

/* ====== 450px ä»¥ä¸‹ï¼šå·¥å…·åˆ— full-bleed + ä¸è¢«æ“ å£“ ====== */
@media (max-width: 450px){

  /* ç›´æ’ï¼šå·¥å…·åˆ—åœ¨ä¸Šã€éŠæˆ²åœ¨ä¸‹ */
  .game-container{
    display:flex;
    flex-direction:column;
  }
  .game-container > .sidebar{ order:1; }
  .game-container > .game-area{ order:2; }

  /* å·¥å…·åˆ—æ”¹æˆ 2 æ¬„ Grid + Full-Bleed */
  .sidebar{
    display:grid !important;
    grid-template-columns: 1fr 1fr;
    grid-template-areas:
      "game-title fruit-info"
      "high-score  exchange";
    gap:12px;

    /* full-bleed è¦†è“‹å·¦å³ç™½é‚Š */
    width:100vw;
    margin-left: calc(50% - 50vw);
    margin-right:calc(50% - 50vw);
    padding:10px 12px;
    box-sizing:border-box;

    /* å®‰å…¨å€ */
    padding-left:  max(12px, env(safe-area-inset-left));
    padding-right: max(12px, env(safe-area-inset-right));
  }
  @supports (width: 100svw){
    .sidebar{
      width:100svw;
      margin-left: calc(50% - 50svw);
      margin-right:calc(50% - 50svw);
    }
  }

  /* é¿å… full-bleed é€ æˆæ°´å¹³å·è»¸ */
  html, body{ overflow-x:hidden !important; }

  /* æŒ‡å®šå››å¡ç‰‡å°æ‡‰ä½ç½® */
  .sidebar .game-title, .sidebar-section.game-title{ grid-area: game-title; }
  .sidebar .fruit-info, .sidebar-section.fruit-info{ grid-area: fruit-info; }
  .sidebar .high-score, .sidebar-section.high-score{ grid-area: high-score; }
  .sidebar .exchange,  .sidebar-section.exchange { grid-area: exchange; }

  /* ğŸ”§ é—œéµï¼šå¾¹åº•è§£é™¤æ¡Œæ©Ÿçš„å›ºå®šå¯¬é«˜ï¼Œå…è¨±åœ¨ Grid å…§ç¸®æ”¾ */
  .sidebar-section,
  .sidebar .game-title,
  .sidebar .high-score,
  .sidebar .exchange,
  .sidebar .fruit-info,
  .sidebar-section.game-title,
  .sidebar-section.high-score,
  .sidebar-section.exchange,
  .sidebar-section.fruit-info{
    width: 100% !important;
    max-width: none !important;
    min-width: 0 !important;
    min-height: auto !important;
    padding: 10px 12px !important;
    border-radius: 6px;
    box-shadow: 0 2px 6px rgba(0,0,0,.15);
    justify-self: stretch !important;
  }

.sidebar-section.game-title{
    min-height: auto !important;     /* é«˜åº¦è‡ªé©æ‡‰ */
    padding: 14px !important;        /* å…§è·ç¸®å° */
    font-size: 14px !important;      /* æ¨™é¡Œå­—ç¸®å° */
    gap: 6px !important;             /* å…§å®¹é–“è·ç¸®å° */
  }


  .sidebar-section.high-score{
    min-height: auto !important;     /* é«˜åº¦è‡ªé©æ‡‰ */
    padding: 39px !important;        /* å…§è·ç¸®å° */
    font-size: 14px !important;      /* æ¨™é¡Œå­—ç¸®å° */
    gap: 6px !important;             /* å…§å®¹é–“è·ç¸®å° */
  }
  /* ä»»ä½•ç›´æ¥å­å…ƒç´ æœ€å°å¯¬åº¦æ­¸é›¶ï¼Œé¿å…å…§å®¹æŠŠæ ¼å­æ’çˆ† */
  .sidebar > *{ min-width:0 !important; }

  /* å…§å®¹å¾®èª¿é˜²æ“ çˆ† */
  .sidebar-section h2{ font-size:16px; margin-bottom:4px; }
  .sidebar-section h3{ font-size:14px; margin-bottom:12px; }
  .sidebar-section h4{ font-size:15px; margin-bottom:4px; }
  .sidebar-section h5{ font-size:14px; margin-bottom:4px; }

  .sidebar-section.fruit-info{ gap:6px; }
  .sidebar-section.fruit-info .fruit{
    padding:1px 8px;
    font-size:13px;
    line-height:1.35;
  }

  /* æŒ‰éˆ•åœ¨å°è¢å¹•æ‹‰æ»¿å¯¬ */
  .again-btn,
  #pauseBtn,
  .sidebar-section.exchange button{
    width:100% !important;
    height:36px;
    font-size:11px;
  }

  /* Drawer åˆ‡æ›éµï¼ˆè‹¥æœ‰ï¼‰é¿å…è²¼é‚Š/ç€æµ· */
  .drawer-toggle{
    top:6px;
    right:max(8px, env(safe-area-inset-right));
  }
  .credit {
        position: fixed;         /* å›ºå®šåœ¨è¦–çª—ï¼Œè€Œä¸æ˜¯è·Ÿè‘—å…§å®¹ */
        bottom: 10px;            /* è·é›¢åº•éƒ¨ 10px */
        right: 10px;             /* è·é›¢å³é‚Š 10px */
        font-size: 8px;         /* å­—é«”å°ä¸€é» */
        color: rgba(0, 0, 0, 0.3); /* åŠé€æ˜ç°è‰² */
        font-style: italic;      /* æ–œé«” */
        pointer-events: none;    /* ä¸å½±éŸ¿æ»‘é¼ é»æ“Š */
        user-select: none;       /* ä¸èƒ½é¸å–æ–‡å­— */
    }
}



    </style>
</head>
<body>
    <!-- ä¸Šæ–¹å·¥å…·åˆ— -->
    <div class="sidebar">
        <button class="drawer-toggle" aria-expanded="true" onclick="toggleDrawer(this)">â¬†</button>
        <!-- éŠæˆ²æ¨™é¡Œ + Again -->
        <div class="sidebar-section game-title">
    <h2>é‡ç¸åˆ‡åˆ‡æ¨‚</h2>
    <button class="again-btn" onclick="restartGame()">again (é‡æ–°)</button>
</div>

<!-- æ­·å²åˆ†æ•¸ + Stop -->
<div class="sidebar-section high-score">
    <h3>æ­·å²æœ€é«˜åˆ†æ•¸</h3>
    <div id="highScore">0</div>
    <button id="pauseBtn" onclick="togglePause()">stop (æš«åœ)</button>
</div>
        <!-- å¯åˆ‡ç‰©é«” -->
    <div class="sidebar-section fruit-info">
        <h4>éŠæˆ²è¦å‰‡</h4>
        <div class="fruit positive">ç æ€ªäºº(+5åˆ†)</div>
        <div class="fruit positive1">ç å¦¹å­(-5åˆ†)</div>
        
    </div>

        <!-- ç©åˆ†å…Œæ› (å‚ç›´æ’åˆ—) -->
        <div class="sidebar-section exchange">
            <h5>ç©åˆ†å…Œæ›</h5>
            <button onclick="spawnSpecialFruit()" id="specialBtn" disabled>
                10 Point â†’ æ™®é€šåœ–ç‰‡  (6ç¨®)
            </button>
            <button onclick="changeBackgroundRandomBlue()" id="blueBtn" disabled>
                20 Point â†’ æ›èƒŒæ™¯  (12ç¨®)
            </button>
            <button onclick="spawnRedEffect()" id="redBtn" disabled>
                50 Point â†’ é«˜ç´šåœ–ç‰‡  (7ç¨®)
            </button> 
        </div>
    </div>

    <!-- ä¸‹æ–¹éŠæˆ²å€åŸŸ -->
    <div class="game-container">
        <div class="game-area" id="gameArea">
            <div class="score-display">Point: <span id="score">0</span></div>
        </div>
    </div>


    <script>
        let gameArea = document.getElementById('gameArea');
        let scoreElement = document.getElementById('score');
        let highScoreElement = document.getElementById('highScore');
        let pauseBtn = document.getElementById('pauseBtn');
        
        let score = 0;
        let highScore = localStorage.getItem('fruitNinjaHighScore') || 0;
        let sessionHighScore = 0; // æœ¬å±€éŠæˆ²çš„æœ€é«˜åˆ†æ•¸
        let isPaused = false;
        let fruits = [];
        let specialFruits = [];
        let sliceLines = [];
        
        let isDrawing = false;
        let lastX = 0;
        let lastY = 0;
        
       const fruitImages = ['imags/logo0.jfif', 'imags/logo2.webp', 'imags/logo4.jfif',];
const bombImages = ['imags/logo6.jfif', 'imags/logo8.jfif','imags/logo10.jfif' ];
const slicedImages = {
    'imags/logo0.jfif': 'imags/logo1.jfif',
    'imags/logo2.webp': 'imags/logo3.jpg',
    'imags/logo4.jfif': 'imags/logo5.jfif',
    'imags/logo6.jfif': 'imags/logo7.jpeg',
    'imags/logo8.jfif': 'imags/logo9.jfif',
    'imags/logo10.jfif':'imags/logo11.jfif',

};
        // åˆå§‹åŒ–
        highScoreElement.textContent = highScore;
        sessionHighScore = 0; // åˆå§‹åŒ–æœ¬å±€æœ€é«˜åˆ†æ•¸
        
        // ç”Ÿæˆæ°´æœå’Œç‚¸å½ˆ
        function spawnFruit() {
            if (isPaused) return;
            
            const isbomb = Math.random() < 0.2;
const imgSrc = isbomb 
 ? bombImages[Math.floor(Math.random() * bombImages.length)] 
  : fruitImages[Math.floor(Math.random() * fruitImages.length)];

const fruit = document.createElement('div');
fruit.className = isbomb ? 'bomb' : 'fruit';
fruit.dataset.type = isbomb ? 'bomb' : 'fruit';
fruit.dataset.src = imgSrc; // å­˜åŸå§‹åœ–ç‰‡è·¯å¾‘

// åŠ åœ–ç‰‡
const img = document.createElement('img');
img.src = imgSrc;
img.className = 'fruit-img';
fruit.appendChild(img);


            
            // å¾è¢å¹•å››é‚Šéš¨æ©Ÿæ‹‹å‡º
            const side = Math.floor(Math.random() * 4);
            let startX, startY, targetX, targetY;
            
            switch(side) {
                case 0: // å·¦é‚Š
                    startX = -50;
                    startY = Math.random() * window.innerHeight;
                    targetX = window.innerWidth + 50;
                    targetY = Math.random() * window.innerHeight;
                    break;
                case 1: // å³é‚Š
                    startX = window.innerWidth + 50;
                    startY = Math.random() * window.innerHeight;
                    targetX = -50;
                    targetY = Math.random() * window.innerHeight;
                    break;
                case 2: // ä¸Šé‚Š
                    startX = Math.random() * window.innerWidth;
                    startY = -50;
                    targetX = Math.random() * window.innerWidth;
                    targetY = window.innerHeight + 50;
                    break;
                case 3: // ä¸‹é‚Š
                    startX = Math.random() * window.innerWidth;
                    startY = window.innerHeight + 50;
                    targetX = Math.random() * window.innerWidth;
                    targetY = -50;
                    break;
            }
            
            fruit.style.left = startX + 'px';
            fruit.style.top = startY + 'px';
            
            gameArea.appendChild(fruit);
            fruits.push({
                element: fruit,
                startX,
                startY,
                targetX,
                targetY,
                progress: 0,
                sliced: false
            });
        }
        
        // æ›´æ–°æ°´æœä½ç½®
        function updateFruits() {
            if (isPaused) return;
            
            fruits.forEach((fruit, index) => {
                if (fruit.sliced) return;
                
                fruit.progress += 0.008;
                
                if (fruit.progress >= 1) {
                    fruit.element.remove();
                    fruits.splice(index, 1);
                    return;
                }
                
                // æ‹‹ç‰©ç·šé‹å‹•
                const t = fruit.progress;
                const x = fruit.startX + (fruit.targetX - fruit.startX) * t;
                const y = fruit.startY + (fruit.targetY - fruit.startY) * t + Math.sin(t * Math.PI) * -200;
                
                fruit.element.style.left = x + 'px';
                fruit.element.style.top = y + 'px';
            });
        }
        
        // æ»‘é¼ å’Œè§¸æ§äº‹ä»¶
        function startSlice(e) {
            if (isPaused) return;
            
            isDrawing = true;
            const rect = gameArea.getBoundingClientRect();
            lastX = (e.clientX || e.touches[0].clientX) - rect.left;
            lastY = (e.clientY || e.touches[0].clientY) - rect.top;
        }
        
        function slice(e) {
            if (!isDrawing || isPaused) return;
            
            e.preventDefault();
            const rect = gameArea.getBoundingClientRect();
            const currentX = (e.clientX || e.touches[0].clientX) - rect.left;
            const currentY = (e.clientY || e.touches[0].clientY) - rect.top;
            
            // å‰µå»ºåŠƒç·šæ•ˆæœ
            const line = document.createElement('div');
            line.className = 'slice-line';
            
            const dx = currentX - lastX;
            const dy = currentY - lastY;
            const length = Math.sqrt(dx * dx + dy * dy);
            const angle = Math.atan2(dy, dx) * 180 / Math.PI;
            
            line.style.left = lastX + 'px';
            line.style.top = lastY + 'px';
            line.style.width = length + 'px';
            line.style.transform = `rotate(${angle}deg)`;
            line.style.transformOrigin = '0 50%';
            
            gameArea.appendChild(line);
            sliceLines.push(line);
            
            // æª¢æŸ¥ç¢°æ’
            checkCollision(lastX, lastY, currentX, currentY);
            
            // æ¸…ç†èˆŠçš„åŠƒç·š
            setTimeout(() => {
                if (line.parentNode) {
                    line.remove();
                    const index = sliceLines.indexOf(line);
                    if (index > -1) sliceLines.splice(index, 1);
                }
            }, 200);
            
            lastX = currentX;
            lastY = currentY;
        }
        
        function endSlice() {
            isDrawing = false;
        }
        
        // ç¢°æ’æª¢æ¸¬
        function checkCollision(x1, y1, x2, y2) {
            fruits.forEach(fruit => {
                if (fruit.sliced) return;
                
                const rect = fruit.element.getBoundingClientRect();
                const gameRect = gameArea.getBoundingClientRect();
                const fruitX = rect.left - gameRect.left + rect.width / 2;
                const fruitY = rect.top - gameRect.top + rect.height / 2;
                
                // ç°¡å–®çš„ç·šæ®µèˆ‡é»çš„è·é›¢åˆ¤æ–·
                const distance = distanceToLine(x1, y1, x2, y2, fruitX, fruitY);
                
                if (distance < 70) { // ç¢°æ’é–¾å€¼
                    sliceFruit(fruit);
                }
            });
        }
        
        // è¨ˆç®—é»åˆ°ç·šæ®µçš„è·é›¢
        function distanceToLine(x1, y1, x2, y2, px, py) {
            const dx = x2 - x1;
            const dy = y2 - y1;
            const length = Math.sqrt(dx * dx + dy * dy);
            
            if (length === 0) return Math.sqrt((px - x1) * (px - x1) + (py - y1) * (py - y1));
            
            const t = Math.max(0, Math.min(1, ((px - x1) * dx + (py - y1) * dy) / (length * length)));
            const projectionX = x1 + t * dx;
            const projectionY = y1 + t * dy;
            
            return Math.sqrt((px - projectionX) * (px - projectionX) + (py - projectionY) * (py - projectionY));
        }
        

        // åœ–ç‰‡å°æ‡‰éŸ³æ•ˆ
const slicedSounds = {
    'imags/logo0.jfif': 'sounds/sound1.mp3',
    'imags/logo2.webp': 'sounds/sound2.mp3',
    'imags/logo4.jfif': 'sounds/sound3.mp3',
    'imags/logo6.jfif': 'sounds/sound4.mp3',
    'imags/logo8.jfif': 'sounds/sound5.mp3',
    'imags/logo10.jfif': 'sounds/sound6.mp3',
};

        function sliceFruit(fruit) {
    fruit.sliced = true;
    const isBomb = fruit.element.dataset.type === 'bomb';
    const originalSrc = fruit.element.dataset.src;

    // æ›æˆè¢«åˆ‡é–‹çš„åœ–ç‰‡
    const newSrc = slicedImages[originalSrc];
    fruit.element.querySelector('img').src = newSrc;
    fruit.element.classList.add('sliced');

    // æ’­æ”¾å°æ‡‰éŸ³æ•ˆ
    const soundSrc = slicedSounds[originalSrc];
    if (soundSrc) {
        const audio = new Audio(soundSrc);
        audio.play();
    }

    // æ›´æ–°åˆ†æ•¸
    if (isBomb) {
        score = Math.max(0, score - 5);
    } else {
        score += 5;
    }
    updateScore();

    // 0.8ç§’å¾Œç§»é™¤
    setTimeout(() => {
        if (fruit.element.parentNode) {
            fruit.element.remove();
        }
        const index = fruits.indexOf(fruit);
        if (index > -1) fruits.splice(index, 1);
    }, 800);
}
        
        // æ›´æ–°åˆ†æ•¸å’ŒæŒ‰éˆ•ç‹€æ…‹
        function updateScore() {
            scoreElement.textContent = score;
            
            // åªæœ‰ç•¶å‰åˆ†æ•¸è¶…éæœ¬å±€æœ€é«˜åˆ†æ•¸æ™‚æ‰æ›´æ–°è¨˜éŒ„
            if (score > sessionHighScore) {
                sessionHighScore = score;
                
                // å¦‚æœæœ¬å±€æœ€é«˜åˆ†æ•¸è¶…éæ­·å²æœ€é«˜åˆ†æ•¸ï¼Œæ›´æ–°æ­·å²è¨˜éŒ„
                if (sessionHighScore > highScore) {
                    highScore = sessionHighScore;
                    highScoreElement.textContent = highScore;
                    localStorage.setItem('fruitNinjaHighScore', highScore);
                }
            }
            
            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            document.getElementById('specialBtn').disabled = score < 10;
            document.getElementById('blueBtn').disabled = score < 20;
            document.getElementById('redBtn').disabled = score < 50;
        }
        
        // ç‰¹æ®Šæ°´æœä¿®æ­£ï¼šimages/
const specialFruitMap = {
  'imags/logo0.jfif': { after: 'imags/logo1.jfif', sound: 'sounds/sound1.mp3' },
  'imags/logo2.webp': { after: 'imags/logo3.jpg',  sound: 'sounds/sound2.mp3' },
  'imags/logo4.jfif': { after: 'imags/logo5.jfif', sound: 'sounds/sound3.mp3' },
  'imags/logo6.jfif': { after: 'imags/logo7.jpeg', sound: 'sounds/sound4.mp3' },
  'imags/logo8.jfif': { after: 'imags/logo9.jfif', sound: 'sounds/sound5.mp3' },
  'imags/logo10.jfif':{ after: 'imags/logo11.jfif',sound: 'sounds/sound6.mp3' }
};

// å¯é¸ï¼šç°¡å–®éŸ³æ•ˆå¿«å–
const audioCache = new Map();
function playSfx(path){
  let a = audioCache.get(path);
  if(!a){ a = new Audio(path); audioCache.set(path, a); }
  // é‡æ–°æ’­æ”¾ï¼ˆæœ‰äº›ç€è¦½å™¨éœ€ cloneNode æ‰èƒ½åŒæ™‚é‡æ’­ï¼‰
  a.currentTime = 0; a.play().catch(()=>{ /* éœé»˜å¤±æ•— */ });
}

function spawnSpecialFruit(){
  if (score < 10) return;
  score -= 10; updateScore();

  const keys = Object.keys(specialFruitMap);
  const originalImg = keys[(Math.random()*keys.length)|0];
  const fruitInfo = specialFruitMap[originalImg];

  const specialFruit = document.createElement('div');
  specialFruit.className = 'special-fruit';
  const img = document.createElement('img');
  img.src = originalImg; img.className = 'fruit-img';
  specialFruit.appendChild(img);

  // å‹•æ…‹å–å¾—å¯¬é«˜
  const size = 60;
  specialFruit.style.left = Math.max(0, Math.random()*(gameArea.offsetWidth  - size)) + 'px';
  specialFruit.style.top  = Math.max(0, Math.random()*(gameArea.offsetHeight - size)) + 'px';

  gameArea.appendChild(specialFruit);
  specialFruits.push(specialFruit);

  let cooling = false;
  const handleTouch = () => {
    if (cooling) return;
    cooling = true;

    specialFruit.classList.remove('touched');
    void specialFruit.offsetWidth;
    specialFruit.classList.add('touched');

    img.src = fruitInfo.after;
    playSfx(fruitInfo.sound);

    setTimeout(() => {
      img.src = originalImg;
      specialFruit.classList.remove('touched');
      cooling = false;
    }, 800);
  };
const isMobile = window.matchMedia('(max-width: 480px)').matches;

if (isMobile) {
 let isDragging = false;
let dragOffsetX = 0, dragOffsetY = 0;
let startX = 0, startY = 0;
const TAP_THRESHOLD = 5;

// æ–°å¢ï¼šæ‹–æ›³éç¨‹æ˜¯å¦å·²è§¸ç™¼é handleTouchï¼ˆé¿å…é€£ç™¼ï¼‰
let playedDuringDrag = false;
const DRAG_TRIGGER = 6; // è¶…é 6px è¦–ç‚ºé–‹å§‹æ‹–æ›³

specialFruit.addEventListener('pointerdown', (e) => {
  e.preventDefault(); e.stopPropagation();
  isDragging = true;
  startX = e.clientX; startY = e.clientY;

  playedDuringDrag = false; // æ¯æ¬¡æŒ‰ä¸‹é‡ç½®

  specialFruit.setPointerCapture?.(e.pointerId);

  const rect = specialFruit.getBoundingClientRect();
  dragOffsetX = e.clientX - rect.left;
  dragOffsetY = e.clientY - rect.top;
  specialFruit.style.zIndex = 1000;
});

specialFruit.addEventListener('pointermove', (e) => {
  if (!isDragging || !specialFruit.parentNode) return;
  e.preventDefault();

  const gameRect = gameArea.getBoundingClientRect();
  const w = specialFruit.offsetWidth  || 60;
  const h = specialFruit.offsetHeight || 60;

  let x = e.clientX - gameRect.left - dragOffsetX;
  let y = e.clientY - gameRect.top  - dragOffsetY;

  const maxX = Math.max(0, gameArea.clientWidth  - w);
  const maxY = Math.max(0, gameArea.clientHeight - h);

  x = Math.max(0, Math.min(x, maxX));
  y = Math.max(0, Math.min(y, maxY));

  specialFruit.style.left = x + 'px';
  specialFruit.style.top  = y + 'px';

  // æ‹–æ›³è¶…éé–€æª» â†’ è§¸ç™¼ä¸€æ¬¡éŸ³æ•ˆ/è®Šèº«
  if (!playedDuringDrag &&
      (Math.abs(e.clientX - startX) > DRAG_TRIGGER ||
       Math.abs(e.clientY - startY) > DRAG_TRIGGER)) {
    playedDuringDrag = true;
    handleTouch(); // å†·å»ç”± handleTouch å…§çš„ cooling æ§åˆ¶
  }
});

const endDrag = (e) => {
  if (!isDragging) return;
  e.preventDefault();

  const isTap =
    Math.abs(e.clientX - startX) < TAP_THRESHOLD &&
    Math.abs(e.clientY - startY) < TAP_THRESHOLD;

  isDragging = false;
  specialFruit.style.zIndex = 90;
  try { specialFruit.releasePointerCapture?.(e.pointerId); } catch {}

  // è‹¥æ˜¯é»æ“Šè€Œéæ‹–æ›³ï¼Œé€™è£¡å†è£œä¸€æ¬¡è§¸ç™¼
  if (isTap && !playedDuringDrag) {
    handleTouch();
  }
};

specialFruit.addEventListener('pointerup', endDrag);
specialFruit.addEventListener('pointercancel', endDrag);

} else {
  // ===== æ¡Œæ©Ÿï¼šæ²¿ç”¨ä½ åŸæœ¬çš„å¯«æ³•ï¼ˆä¿ç•™ï¼‰======
  specialFruit.addEventListener('click',      (e)=>{ e.stopPropagation(); handleTouch(); }, {passive:true});
  specialFruit.addEventListener('touchstart', (e)=>{ e.stopPropagation(); handleTouch(); }, {passive:true});

  let isDragging=false, dragOffsetX=0, dragOffsetY=0;
  specialFruit.addEventListener('mousedown', (e)=>{
    e.preventDefault(); e.stopPropagation();
    isDragging=true;
    const rect=specialFruit.getBoundingClientRect();
    dragOffsetX = e.clientX - rect.left;
    dragOffsetY = e.clientY - rect.top;
    specialFruit.style.zIndex=1000;
    handleTouch();
  });

  const onMove=(e)=>{
    if(!isDragging || !specialFruit.parentNode) return;
    const gameRect = gameArea.getBoundingClientRect();
    const clientX = e.clientX ?? (e.touches && e.touches[0].clientX);
    const clientY = e.clientY ?? (e.touches && e.touches[0].clientY);
    if(clientX==null) return;

    const w = specialFruit.offsetWidth  || 60;
    const h = specialFruit.offsetHeight || 60;

    let x = clientX - gameRect.left - dragOffsetX;
    let y = clientY - gameRect.top  - dragOffsetY;
    x = Math.max(0, Math.min(x, gameArea.offsetWidth  - w));
    y = Math.max(0, Math.min(y, gameArea.offsetHeight - h));
    specialFruit.style.left = x + 'px';
    specialFruit.style.top  = y + 'px';
  };

  const endDrag=()=>{ if(isDragging){ isDragging=false; specialFruit.style.zIndex=90; } };

  document.addEventListener('mousemove', onMove);
  document.addEventListener('mouseup',   endDrag, {once:false});
  document.addEventListener('touchmove', onMove,  {passive:false});
  document.addEventListener('touchend',  endDrag, {once:false});
}
}


// è—è‰²æŒ‰éˆ•å°ˆç”¨ â†’ { æ›èƒŒæ™¯ }
const blueBackgroundsDesktop = [
  
  'imags/logo0.jfif',
  'imags/logo1.jfif',
  'imags/logo4.jfif',
  'imags/logo20.jfif',
  
  'imags/logo17.jfif',
  'imags/logo16.jfif',
  'imags/logo15.jfif',
  'imags/logo13.jfif',
  
];

// æ‰‹æ©Ÿï¼ˆâ‰¤450pxï¼‰ç”¨èƒŒæ™¯
const blueBackgroundsMobile = [
   'imags/logo0.jfif',
  'imags/logo1.jfif',
  'imags/logo3.jpg',
  'imags/logo14.jfif',
   'imags/logo13.jfif',
   'imags/logo16.jfif',
  'imags/logo15.jfif',
  'imags/logo12.jpg',
  'imags/logo18.jfif',
  // â€¦æ”¾ä½ æƒ³çµ¦æ‰‹æ©Ÿç”¨çš„åœ–
];
// å–å¾—ç•¶å‰æ‡‰ç”¨çš„èƒŒæ™¯æ¸…å–®
function getBlueBackgrounds() {
  return window.matchMedia('(max-width: 450px)').matches
    ? blueBackgroundsMobile
    : blueBackgroundsDesktop;
}

function changeBackgroundRandomBlue() {
  if (score < 20) return; // æŒ‰éˆ•æ¶ˆè€— 20 åˆ†
  score -= 20;
  updateScore();

  const list = getBlueBackgrounds();
  if (!list.length) return;

  const randomImg = list[Math.floor(Math.random() * list.length)];
  gameArea.style.backgroundImage = `url(${randomImg})`;
  gameArea.style.backgroundSize = 'cover';
  gameArea.style.backgroundPosition = 'center';
}



// é«˜ç´šåœ–ç‰‡å°ˆç”¨ â†’ { after: è®Šèº«åœ–ç‰‡, sound: å°æ‡‰éŸ³æ•ˆ }
const redEffectMap = {
  'imags/logo21.png': { after: 'imags/logo22.png', sound: 'sounds/sound7.mp3' },
  'imags/logo16.jfif': { after: 'imags/logo15.jfif', sound: 'sounds/sound10.mp3' },
  'imags/logo23.jfif': { after: 'imags/logo29.jfif', sound: 'sounds/sound8.mp3' },
  'imags/logo24.jfif': { after: 'imags/logo26.jpg', sound: 'sounds/sound9.mp3' },
  'imags/logo0.jfif': { after: 'imags/logo25.jpg', sound: 'sounds/sound13.mp3' },
  'imags/logo17.jfif': { after: 'imags/logo28.jfif', sound: 'sounds/sound11.mp3' },
  'imags/logo1.jfif': { after: 'imags/logo27.jpg', sound: 'sounds/sound12.mp3' },

  
};
        
function spawnRedEffect() {
  if (score < 50) return; // æŒ‰éˆ•æ¶ˆè€— 50 åˆ†
  score -= 50;
  updateScore();

  // éš¨æ©ŸæŒ‘ä¸€å¼µ
  const keys = Object.keys(redEffectMap);
  const originalImg = keys[Math.floor(Math.random() * keys.length)];
  const effectInfo = redEffectMap[originalImg]; // after + sound

  const effectDiv = document.createElement('div');
  effectDiv.className = 'special-red';

  // åŠ åœ–ç‰‡
  const img = document.createElement('img');
  img.src = originalImg;
  img.className = 'fruit-img';
  effectDiv.appendChild(img);

  // éš¨æ©Ÿä½ç½®
  const baseSize = 60;
  effectDiv.style.left = Math.max(0, Math.random() * (gameArea.offsetWidth  - baseSize)) + 'px';
  effectDiv.style.top  = Math.max(0, Math.random() * (gameArea.offsetHeight - baseSize)) + 'px';

  gameArea.appendChild(effectDiv);

  // è§¸ç™¼ï¼šæ›åœ– + éŸ³æ•ˆ + å›åŸåœ–ï¼ˆå«å†·å»ï¼‰
  let cooling = false;
  const handleTouch = () => {
    if (cooling) return;
    cooling = true;

    effectDiv.classList.remove('touched');
    void effectDiv.offsetWidth;          // é‡æ–°è§¸ç™¼ CSS å‹•ç•«
    effectDiv.classList.add('touched');

    img.src = effectInfo.after;
    playSfx(effectInfo.sound);           // ğŸ” ç”¨å¿«å–éŸ³æ•ˆ

    setTimeout(() => {
      img.src = originalImg;
      effectDiv.classList.remove('touched');
      cooling = false;
    }, 800);
  };

  // â€”â€” ä¾è¢å¹•å¯¬åº¦é¸äº‹ä»¶æ¨¡å‹ï¼šâ‰¤480 ç”¨ Pointerï¼Œå…¶ä»–ç”¨åŸæœ¬æ¡Œæ©Ÿæ»‘é¼  â€”â€”
  const isMobile = window.matchMedia('(max-width: 480px)').matches;

  if (isMobile) {
    // ===== æ‰‹æ©Ÿ/å°è¢å¹•ï¼šPointer Events =====
    let isDragging = false;
let dragOffsetX = 0, dragOffsetY = 0;
let startX = 0, startY = 0;
const TAP_THRESHOLD = 5;

// âœ… æ–°å¢ï¼šæ‹–æ›³æ™‚æ˜¯å¦å·²è§¸ç™¼ééŸ³æ•ˆ/è®Šèº«
let playedDuringDrag = false;
const DRAG_TRIGGER = 6; // è¶…é 6px è¦–ç‚ºé–‹å§‹æ‹–æ›³

effectDiv.addEventListener('pointerdown', (e) => {
  e.preventDefault(); e.stopPropagation();
  isDragging = true;
  startX = e.clientX; startY = e.clientY;

  playedDuringDrag = false;      // âœ… æ¯æ¬¡æ–°æŒ‰ä¸‹å°±é‡ç½®

  effectDiv.setPointerCapture?.(e.pointerId);

  const rect = effectDiv.getBoundingClientRect();
  dragOffsetX = e.clientX - rect.left;
  dragOffsetY = e.clientY - rect.top;
  effectDiv.style.zIndex = 1000;
});

effectDiv.addEventListener('pointermove', (e) => {
  if (!isDragging || !effectDiv.parentNode) return;
  e.preventDefault();

  const gameRect = gameArea.getBoundingClientRect();
  const w = effectDiv.offsetWidth  || baseSize;
  const h = effectDiv.offsetHeight || baseSize;

  let x = e.clientX - gameRect.left - dragOffsetX;
  let y = e.clientY - gameRect.top  - dragOffsetY;

  const maxX = Math.max(0, gameArea.clientWidth  - w);
  const maxY = Math.max(0, gameArea.clientHeight - h);

  x = Math.max(0, Math.min(x, maxX));
  y = Math.max(0, Math.min(y, maxY));

  effectDiv.style.left = x + 'px';
  effectDiv.style.top  = y + 'px';

  // âœ… æ–°å¢ï¼šæ‹–æ›³è¶…éé–€æª»ï¼Œè§¸ç™¼ä¸€æ¬¡éŸ³æ•ˆ/è®Šèº«
  if (!playedDuringDrag &&
      (Math.abs(e.clientX - startX) > DRAG_TRIGGER ||
       Math.abs(e.clientY - startY) > DRAG_TRIGGER)) {
    playedDuringDrag = true;
    handleTouch(); // å†·å»æ©Ÿåˆ¶å·²åœ¨ handleTouch å…§è™•ç†
  }
});

const endDrag = (e) => {
  if (!isDragging) return;
  e.preventDefault();

  const isTap =
    Math.abs(e.clientX - startX) < TAP_THRESHOLD &&
    Math.abs(e.clientY - startY) < TAP_THRESHOLD;

  isDragging = false;
  effectDiv.style.zIndex = 90;
  try { effectDiv.releasePointerCapture?.(e.pointerId); } catch {}

  // é»æ“Šæ‰åœ¨é€™è£¡è§¸ç™¼ï¼›è‹¥æ‹–æ›³æ™‚å·²è§¸ç™¼éï¼Œå°±ä¸å†æ’­
  if (isTap && !playedDuringDrag) {
    handleTouch();
  }
};

effectDiv.addEventListener('pointerup', endDrag);
effectDiv.addEventListener('pointercancel', endDrag);
  } else {
    // ===== æ¡Œæ©Ÿï¼šæ²¿ç”¨ä½ åŸæœ¬çš„æ»‘é¼ äº‹ä»¶ =====
    // é»æ“Š/è§¸æ§ï¼ˆæ²¿ç”¨èˆŠé‚è¼¯ï¼‰
    effectDiv.addEventListener('click',      (e) => { e.stopPropagation(); handleTouch(); }, { passive: true });
    effectDiv.addEventListener('touchstart', (e) => { e.stopPropagation(); handleTouch(); }, { passive: true });

    // æ‹–æ›³
    let isDragging = false;
    let dragOffsetX = 0, dragOffsetY = 0;

    effectDiv.addEventListener('mousedown', (e) => {
      e.preventDefault(); e.stopPropagation();
      isDragging = true;
      const rect = effectDiv.getBoundingClientRect();
      dragOffsetX = e.clientX - rect.left;
      dragOffsetY = e.clientY - rect.top;
      effectDiv.style.zIndex = 1000;
      handleTouch(); // è‹¥ä½ å¸Œæœ›æ‹–æ›³é–‹å§‹å°±æœ‰ç‰¹æ•ˆï¼Œä¿ç•™é€™è¡Œ
    });

    const onMove = (e) => {
      if (!isDragging || !effectDiv.parentNode) return;
      e.preventDefault();
      const gameRect = gameArea.getBoundingClientRect();

      const w = effectDiv.offsetWidth  || baseSize;
      const h = effectDiv.offsetHeight || baseSize;

      let x = e.clientX - gameRect.left - dragOffsetX;
      let y = e.clientY - gameRect.top  - dragOffsetY;
      x = Math.max(0, Math.min(x, gameArea.offsetWidth  - w));
      y = Math.max(0, Math.min(y, gameArea.offsetHeight - h));
      effectDiv.style.left = x + 'px';
      effectDiv.style.top  = y + 'px';
      
    };

    const endDrag = () => {
      if (isDragging) {
        isDragging = false;
        effectDiv.style.zIndex = 90;
      }
    };

    document.addEventListener('mousemove', onMove);
    document.addEventListener('mouseup',   endDrag, { once: false });
    document.addEventListener('touchmove', onMove,  { passive: false });
    document.addEventListener('touchend',  endDrag, { once: false });
  }
}

        // æš«åœ/ç¹¼çºŒ
        function togglePause() {
            isPaused = !isPaused;
            pauseBtn.textContent = isPaused ? 'start (é–‹å§‹)' : 'stop (æš«åœ)';
        }
        
        // é‡æ–°é–‹å§‹
function restartGame() {
    score = 0;
    sessionHighScore = 0; // é‡ç½®æœ¬å±€æœ€é«˜åˆ†æ•¸
    isPaused = false;
    updateScore();
    pauseBtn.textContent = 'stop (æš«åœ)';

    // æ¸…é™¤æ‰€æœ‰æ°´æœå’Œç‰¹æ®Šæ•ˆæœ
    fruits.forEach(fruit => fruit.element.remove());
    specialFruits.forEach(fruit => fruit.remove());
    sliceLines.forEach(line => line.remove());

    // âœ… æ–°å¢ï¼šæ¸…é™¤æ‰€æœ‰ .special-red åœ–æ¡ˆ
    document.querySelectorAll('.special-red').forEach(el => el.remove());

    // æ¸…ç©ºé™£åˆ—
    fruits = [];
    specialFruits = [];
    sliceLines = [];

    // é‡ç½®èƒŒæ™¯
    document.body.className = '';
    gameArea.className = 'game-area';
}
        
        // äº‹ä»¶ç›£è½å™¨
        gameArea.addEventListener('mousedown', startSlice);
        gameArea.addEventListener('mousemove', slice);
        gameArea.addEventListener('mouseup', endSlice);
        
        gameArea.addEventListener('touchstart', startSlice, { passive: false });
        gameArea.addEventListener('touchmove', slice, { passive: false });
        gameArea.addEventListener('touchend', endSlice);
        
        // éŠæˆ²ä¸»å¾ªç’°
        setInterval(() => {
            if (Math.random() < 0.02) { // 2% æ©Ÿç‡æ¯å¹€ç”Ÿæˆæ°´æœ
                spawnFruit();
            }
            updateFruits();
        }, 16); // ~60 FPS
    </script>
    <script>
    function toggleDrawer(btn){
      const collapsed = document.body.classList.toggle('drawer-collapsed');
      btn.textContent = collapsed ? 'â¬‡' : 'â¬†';
      btn.setAttribute('aria-expanded', String(!collapsed));
    }
  </script>
  <div class="credit">æ„Ÿè¬ é»ƒéŸ‹å‚‘å­¸è€… æä¾›</div>
</body>
</html>